<!DOCTYPE html>
<!-- The SkyMines Status Page Status Page
     Written by 0xLogN                    -->

<!--
  We use one file of HTML, to avoid external loads. This script
  should be VERY FAST.
-->
<html>
  <head>
    <style>
      .hidden { display: none; }
    </style>
  </head>
  <body>
    <div id="oninit"><p>sending you to the status page...</p></div>
    <div class="hidden" id="onserverdown">
      <h1>The SkyMines Status Page is down.</h1>
      <p>Ah... that was suprising! Did you expect us to have a status page for the status page? Well.. we do.<br/><br/>The status page is currently down. This is most likely due to network issues or maintanence. Check back later.</p>
    </div>
    <script>
      console.log('run test for http://skymines.ml:3001/');
      fetchWithTimeout('http://skymines.ml:3001/', {timeout:3000}).then(() => {
        window.location.replace("http://skymines.ml:3001/");
      }).catch(e => {
        console.log('show hidden sec');
        document.getElementById('oninit').classList.add('hidden');
        document.getElementById('onserverdown').classList.remove('hidden');
      });
      
      async function fetchWithTimeout(resource, options = {}) {
        const { timeout = 8000 } = options;
  
        const controller = new AbortController();
        const id = setTimeout(() => controller.abort(), timeout);
        const response = await fetch(resource, {
          ...options,
          signal: controller.signal  
        });
        clearTimeout(id);
        return response;
      }
    </script>
  </body>
</html>
